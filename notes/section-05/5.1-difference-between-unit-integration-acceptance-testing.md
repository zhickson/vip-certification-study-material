# 5.1 Difference Between Unit, Integration, and Acceptance Testing - Study Notes

## Overview

Understanding the different types of testing is crucial for building reliable WordPress applications. Each testing type serves a specific purpose in the development lifecycle and validates different aspects of the system.

**Key Reference:** [Testing - WordPress Developer Resources](https://developer.wordpress.org/advanced-administration/wordpress/development-tools/)

---

## 1. Unit Testing

### Definition

**Unit testing** tests individual units of code (functions, methods, classes) in isolation from the rest of the system. Each unit is tested independently to verify it works correctly.

### Characteristics

- **Scope:** Single function, method, or class
- **Dependencies:** Mocked or stubbed
- **Speed:** Fast execution
- **Isolation:** No database, no WordPress bootstrap
- **Purpose:** Verify logic correctness

### Example - Unit Test

```php
// tests/unit/class-calculator-test.php
class Calculator_Test extends PHPUnit\Framework\TestCase {
	public function test_add_returns_correct_sum() {
		$calculator = new Calculator();
		$result = $calculator->add( 2, 3 );
		$this->assertEquals( 5, $result );
	}

	public function test_multiply_handles_zero() {
		$calculator = new Calculator();
		$result = $calculator->multiply( 5, 0 );
		$this->assertEquals( 0, $result );
	}
}
```

### When to Use Unit Tests

- Testing pure functions (no side effects)
- Testing business logic
- Testing utility functions
- Fast feedback during development
- Testing edge cases and error handling

### Benefits

- **Fast:** Execute in milliseconds
- **Isolated:** No external dependencies
- **Reliable:** Deterministic results
- **Early Detection:** Catch bugs before integration

---

## 2. Integration Testing

### Definition

**Integration testing** tests how multiple components work together. In WordPress, this includes testing interactions between plugins, themes, database, and core functionality.

### Characteristics

- **Scope:** Multiple components working together
- **Dependencies:** Real WordPress environment
- **Speed:** Slower than unit tests
- **Isolation:** Uses test database
- **Purpose:** Verify component interactions

### Example - Integration Test

```php
// tests/integration/class-post-meta-test.php
class Post_Meta_Integration_Test extends WP_UnitTestCase {
	public function test_save_post_meta_creates_database_entry() {
		$post_id = self::factory()->post->create( array(
			'post_title' => 'Test Post',
		) );

		update_post_meta( $post_id, 'custom_field', 'test_value' );

		$meta_value = get_post_meta( $post_id, 'custom_field', true );
		$this->assertEquals( 'test_value', $meta_value );
	}

	public function test_custom_post_type_registration() {
		register_post_type( 'product' );

		$post_types = get_post_types();
		$this->assertContains( 'product', $post_types );
	}

	public function test_hook_fires_on_post_save() {
		$fired = false;

		add_action( 'save_post', function() use ( &$fired ) {
			$fired = true;
		} );

		$post_id = self::factory()->post->create();
		wp_update_post( array( 'ID' => $post_id, 'post_title' => 'Updated' ) );

		$this->assertTrue( $fired );
	}
}
```

### When to Use Integration Tests

- Testing WordPress API interactions
- Testing database operations
- Testing hook interactions
- Testing plugin/theme compatibility
- Testing custom post types and taxonomies
- Testing REST API endpoints

### Benefits

- **Real Environment:** Tests actual WordPress behaviour
- **Component Interaction:** Verifies integration points
- **Database Testing:** Validates data persistence
- **Hook Testing:** Verifies WordPress hooks work correctly

---

## 3. Acceptance Testing (UAT)

### Definition

**Acceptance testing** (User Acceptance Testing - UAT) validates that the system meets business requirements and works from an end-user perspective. It tests complete user workflows.

### Characteristics

- **Scope:** Complete user workflows
- **Dependencies:** Full WordPress installation
- **Speed:** Slowest type of testing
- **Isolation:** May use production-like environment
- **Purpose:** Verify business requirements

### Example - Acceptance Test Scenario

```gherkin
# features/user-registration.feature
Feature: User Registration
	As a site visitor
	I want to register for an account
	So that I can access member content

	Scenario: Successful registration
		Given I am on the registration page
		When I fill in "Username" with "newuser"
		And I fill in "Email" with "user@example.com"
		And I fill in "Password" with "securepass123"
		And I click "Register"
		Then I should see "Registration successful"
		And I should be logged in as "newuser"

	Scenario: Registration with invalid email
		Given I am on the registration page
		When I fill in "Email" with "invalid-email"
		And I click "Register"
		Then I should see "Invalid email address"
```

### When to Use Acceptance Tests

- Testing complete user workflows
- Validating business requirements
- Testing user-facing features
- Pre-deployment validation
- Client/stakeholder validation

### Benefits

- **User Perspective:** Tests from end-user viewpoint
- **Business Validation:** Verifies requirements are met
- **Workflow Testing:** Tests complete user journeys
- **Stakeholder Confidence:** Demonstrates working features

---

## 4. Comparison Table

| Aspect | Unit Tests | Integration Tests | Acceptance Tests |
|--------|------------|-------------------|------------------|
| **Scope** | Single function/class | Multiple components | Complete workflows |
| **Speed** | Very fast | Moderate | Slow |
| **Dependencies** | Mocked | Real WordPress | Full environment |
| **Database** | No | Test database | Production-like |
| **WordPress Bootstrap** | No | Yes | Yes |
| **Purpose** | Logic correctness | Component interaction | Business requirements |
| **Maintenance** | Low | Medium | High |
| **Feedback Speed** | Immediate | Fast | Slow |

---

## 5. Testing Pyramid

The testing pyramid illustrates the ideal distribution of tests:

```
        /\
       /  \     Acceptance Tests (Few)
      /____\
     /      \   Integration Tests (Some)
    /________\
   /          \  Unit Tests (Many)
  /____________\
```

### Distribution

- **Unit Tests:** 70% - Fast, many tests
- **Integration Tests:** 20% - Moderate speed, some tests
- **Acceptance Tests:** 10% - Slow, few critical workflows

---

## 6. WordPress-Specific Considerations

### Unit Testing in WordPress

WordPress functions often depend on global state, making pure unit tests challenging:

```php
// ❌ Difficult to unit test - depends on WordPress globals
function get_user_posts( $user_id ) {
	$user = get_userdata( $user_id );
	return get_posts( array( 'author' => $user_id ) );
}

// ✅ Better - can be unit tested
function calculate_post_count( $posts ) {
	return count( $posts );
}
```

### Integration Testing with WP_UnitTestCase

WordPress provides `WP_UnitTestCase` for integration tests:

```php
class My_Plugin_Test extends WP_UnitTestCase {
	public function setUp() {
		parent::setUp();
		// Set up test data
	}

	public function tearDown() {
		parent::tearDown();
		// Clean up
	}

	public function test_plugin_functionality() {
		// Test with real WordPress environment
	}
}
```

### Acceptance Testing Tools

- **Codeception:** PHP testing framework with acceptance testing
- **Behat:** BDD framework for acceptance testing
- **WP Browser:** WordPress-specific acceptance testing
- **Selenium:** Browser automation for UI testing

---

## 7. How Testing Contributes to Stability

### Early Bug Detection

- **Unit Tests:** Catch logic errors immediately
- **Integration Tests:** Find component interaction issues
- **Acceptance Tests:** Verify features work end-to-end

### Regression Prevention

- Tests prevent breaking existing functionality
- Continuous integration runs tests on every change
- Automated testing catches issues before deployment

### Documentation

- Tests serve as living documentation
- Show how code is expected to work
- Provide examples of usage

### Refactoring Confidence

- Tests enable safe refactoring
- Verify behaviour doesn't change
- Reduce fear of breaking code

---

## Exam Tips

### Key Points to Remember

1. **Unit Testing:**
   - Tests individual units in isolation
   - Fast, no dependencies
   - Use for logic and utility functions

2. **Integration Testing:**
   - Tests component interactions
   - Uses real WordPress environment
   - Use for API and database operations

3. **Acceptance Testing:**
   - Tests complete user workflows
   - Validates business requirements
   - Use for end-to-end validation

4. **Testing Pyramid:**
   - Many unit tests (70%)
   - Some integration tests (20%)
   - Few acceptance tests (10%)

5. **WordPress Considerations:**
   - Use `WP_UnitTestCase` for integration tests
   - Mock WordPress functions for unit tests
   - Use acceptance testing tools for UAT

---

## Additional Resources

- [Testing - WordPress Developer Resources](https://developer.wordpress.org/advanced-administration/wordpress/development-tools/)
- [PHPUnit - Official Documentation](https://phpunit.de/)
- [Codeception - PHP Testing Framework](https://codeception.com/)
- [Behat - BDD Framework](https://docs.behat.org/)
- [WP Browser - WordPress Acceptance Testing](https://wpbrowser.wptestkit.dev/)
