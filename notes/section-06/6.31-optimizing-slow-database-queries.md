# 6.31 Optimizing Slow Database Queries - Study Notes

## Overview

Optimizing slow database queries involves using EXPLAIN to interpret execution plans, applying indexing strategies, and identifying slow queries with Query Monitor.

**Key Reference:** [Using EXPLAIN - Section 4.7](../section-04/4.7-using-explain.md) | [Indexing - Section 4.5](../section-04/4.5-indexing.md) | [Query Monitor - Section 6.2](./6.2-query-monitor.md)

---

## 1. Using EXPLAIN to Interpret Execution Plans

### EXPLAIN Basics

**Run EXPLAIN:**
```sql
EXPLAIN SELECT * FROM wp_posts WHERE post_type = 'post';
```

**Key Columns:**
- `type`: Access method (ALL = bad, const = best)
- `key`: Index used (NULL = no index)
- `rows`: Rows examined
- `Extra`: Additional info (Using filesort = bad)

### WordPress Query Analysis

**Get Query from WP_Query:**
```php
$query = new WP_Query( $args );
global $wpdb;
$sql = $wpdb->last_query;
$explain = $wpdb->get_results( "EXPLAIN $sql" );
```

---

## 2. Applying Indexing Strategies

### Identify Missing Indexes

**Check EXPLAIN Output:**
- `type: ALL` = missing index
- `key: NULL` = no index used
- `rows: high number` = inefficient

### Add Indexes

**Create Index:**
```sql
CREATE INDEX idx_post_type ON wp_posts(post_type);
```

**Composite Index:**
```sql
CREATE INDEX idx_type_status ON wp_posts(post_type, post_status);
```

---

## 3. Identifying Slow Queries with Query Monitor

### Query Monitor Features

**Slow Query Detection:**
- Queries > 10ms highlighted
- Shows execution time
- Displays query caller
- Provides EXPLAIN analysis

**Usage:**
- Install Query Monitor
- View queries panel
- Click query for EXPLAIN
- Identify slow queries

---

## Exam Tips

### Key Points to Remember

1. **EXPLAIN:**
   - Shows execution plan
   - Identifies missing indexes
   - Reveals performance issues

2. **Indexing:**
   - Add indexes for slow queries
   - Use composite indexes
   - Monitor index usage

3. **Query Monitor:**
   - Identifies slow queries
   - Provides EXPLAIN
   - Shows callers

---

## Additional Resources

- [Using EXPLAIN - Section 4.7](../section-04/4.7-using-explain.md)
- [Indexing - Section 4.5](../section-04/4.5-indexing.md)
- [Query Monitor - Section 6.2](./6.2-query-monitor.md)
