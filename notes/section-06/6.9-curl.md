# 6.9 cURL - Study Notes

## Overview

cURL is a command-line tool for transferring data with URLs. It's essential for testing WordPress endpoints, APIs, and debugging HTTP requests from the command line.

**Key Reference:** [cURL Documentation](https://curl.se/docs/)

---

## 1. Sending GET/POST Requests to WordPress Endpoints

### Basic GET Request

**Simple Request:**
```bash
curl https://example.com
```

**GET with Headers:**
```bash
curl -H "Accept: application/json" https://example.com/wp-json/wp/v2/posts
```

### POST Request

**Basic POST:**
```bash
curl -X POST https://example.com/wp-json/wp/v2/posts \
  -d "title=Test Post" \
  -d "content=Test Content"
```

**POST with JSON:**
```bash
curl -X POST https://example.com/wp-json/wp/v2/posts \
  -H "Content-Type: application/json" \
  -d '{"title":"Test Post","content":"Test Content"}'
```

### WordPress REST API

**Get Posts:**
```bash
curl https://example.com/wp-json/wp/v2/posts
```

**Create Post:**
```bash
curl -X POST https://example.com/wp-json/wp/v2/posts \
  -u "username:application_password" \
  -H "Content-Type: application/json" \
  -d '{"title":"New Post","content":"Post content"}'
```

**Update Post:**
```bash
curl -X POST https://example.com/wp-json/wp/v2/posts/123 \
  -u "username:application_password" \
  -H "Content-Type: application/json" \
  -d '{"title":"Updated Post"}'
```

**Delete Post:**
```bash
curl -X DELETE https://example.com/wp-json/wp/v2/posts/123 \
  -u "username:application_password"
```

---

## 2. Simulating Headers, Cookies, and Authentication

### Custom Headers

**Set Headers:**
```bash
curl -H "User-Agent: MyApp/1.0" \
  -H "Accept: application/json" \
  -H "X-Custom-Header: value" \
  https://example.com
```

**Multiple Headers:**
```bash
curl -H "Content-Type: application/json" \
  -H "Authorization: Bearer token123" \
  https://example.com/api/endpoint
```

### Cookies

**Send Cookies:**
```bash
curl -b "wordpress_logged_in_abc123=value" https://example.com/wp-admin
```

**Cookie File:**
```bash
# Save cookies
curl -c cookies.txt https://example.com/login

# Use saved cookies
curl -b cookies.txt https://example.com/wp-admin
```

### Authentication

**Basic Auth:**
```bash
curl -u "username:password" https://example.com/wp-json/wp/v2/posts
```

**Bearer Token:**
```bash
curl -H "Authorization: Bearer token123" https://example.com/api/endpoint
```

**WordPress Application Password:**
```bash
curl -u "username:application_password" https://example.com/wp-json/wp/v2/posts
```

**WordPress Nonce:**
```bash
curl -H "X-WP-Nonce: nonce123" \
  -H "Cookie: wordpress_logged_in_abc123=value" \
  https://example.com/wp-admin/admin-ajax.php
```

---

## 3. Inspecting Raw Responses for Debugging

### View Response Headers

**Headers Only:**
```bash
curl -I https://example.com
```

**Verbose Output:**
```bash
curl -v https://example.com
```

**Headers and Body:**
```bash
curl -i https://example.com
```

### Response Details

**Verbose Mode Shows:**
- Request headers
- Response headers
- SSL/TLS information
- Connection details
- Timing information

**Example Output:**
```
* Connected to example.com (192.0.2.1) port 443
* SSL connection using TLSv1.2
> GET / HTTP/1.1
> Host: example.com
> User-Agent: curl/7.68.0
>
< HTTP/1.1 200 OK
< Content-Type: text/html
< Content-Length: 12345
```

### Save Response

**Save to File:**
```bash
curl -o response.html https://example.com
```

**Save Headers:**
```bash
curl -D headers.txt https://example.com
```

**Save Both:**
```bash
curl -D headers.txt -o response.html https://example.com
```

---

## 4. Common cURL Options for WordPress

### Follow Redirects

**Follow Redirects:**
```bash
curl -L https://example.com
```

**Limit Redirects:**
```bash
curl -L --max-redirs 5 https://example.com
```

### SSL/TLS Options

**Ignore SSL Certificate:**
```bash
curl -k https://example.com
```

**Specify CA Bundle:**
```bash
curl --cacert /path/to/ca-bundle.crt https://example.com
```

### Timeout Options

**Set Timeout:**
```bash
curl --connect-timeout 10 --max-time 30 https://example.com
```

### Output Options

**Silent Mode:**
```bash
curl -s https://example.com
```

**Show Progress:**
```bash
curl --progress-bar https://example.com
```

**Show Errors Only:**
```bash
curl -S https://example.com
```

---

## 5. WordPress-Specific cURL Examples

### Testing REST API

**List Posts:**
```bash
curl https://example.com/wp-json/wp/v2/posts
```

**Get Single Post:**
```bash
curl https://example.com/wp-json/wp/v2/posts/123
```

**Search Posts:**
```bash
curl "https://example.com/wp-json/wp/v2/posts?search=test"
```

### Testing AJAX

**AJAX Request:**
```bash
curl -X POST https://example.com/wp-admin/admin-ajax.php \
  -d "action=my_action" \
  -d "data=value" \
  -H "X-WP-Nonce: nonce123" \
  -b "wordpress_logged_in_abc123=value"
```

### Testing Authentication

**Check Authentication:**
```bash
curl -u "username:application_password" \
  https://example.com/wp-json/wp/v2/users/me
```

### Testing Caching

**Check Cache Headers:**
```bash
curl -I https://example.com
```

**Bypass Cache:**
```bash
curl -H "Cache-Control: no-cache" https://example.com
```

---

## 6. Debugging with cURL

### Common Debugging Scenarios

**1. Test Endpoint Availability:**
```bash
curl -I https://example.com/wp-json/wp/v2/posts
```

**2. Check Authentication:**
```bash
curl -u "username:password" https://example.com/wp-json/wp/v2/users/me
```

**3. Test POST Request:**
```bash
curl -X POST https://example.com/wp-json/wp/v2/posts \
  -H "Content-Type: application/json" \
  -d '{"title":"Test"}' \
  -v
```

**4. Check Redirects:**
```bash
curl -L -v https://example.com
```

**5. Test with Cookies:**
```bash
curl -b "cookie=value" -v https://example.com
```

### Error Handling

**Check HTTP Status:**
```bash
curl -w "%{http_code}" -o /dev/null -s https://example.com
```

**Check Response Time:**
```bash
curl -w "Time: %{time_total}s\n" -o /dev/null -s https://example.com
```

**Comprehensive Output:**
```bash
curl -w "\nHTTP Code: %{http_code}\nTime: %{time_total}s\nSize: %{size_download} bytes\n" \
  -o /dev/null -s https://example.com
```

---

## Exam Tips

### Key Points to Remember

1. **Basic Usage:**
   - GET: `curl URL`
   - POST: `curl -X POST URL -d "data"`
   - Headers: `-H "Header: value"`

2. **Authentication:**
   - Basic: `-u "user:pass"`
   - Bearer: `-H "Authorization: Bearer token"`
   - Cookies: `-b "cookie=value"`

3. **Debugging:**
   - Headers: `-I` or `-v`
   - Follow redirects: `-L`
   - Save response: `-o file`

4. **WordPress:**
   - REST API: `/wp-json/wp/v2/`
   - AJAX: `/wp-admin/admin-ajax.php`
   - Application passwords for auth

5. **Common Options:**
   - Verbose: `-v`
   - Silent: `-s`
   - Timeout: `--max-time`
   - SSL: `-k` (insecure)

---

## Additional Resources

- [cURL Documentation](https://curl.se/docs/)
- [cURL Manual](https://curl.se/docs/manual.html)
- [WordPress REST API Handbook](https://developer.wordpress.org/rest-api/)
- [HTTPie - Alternative to cURL](https://httpie.io/)
