# 6.15 WordPress Shell - Study Notes

## Overview

WordPress shell (wp shell) and WP Console provide interactive PHP environments for debugging WordPress, allowing real-time evaluation of PHP expressions, variable inspection, and function testing without modifying code.

**Key Reference:** [WP-CLI Shell](https://wp-cli.org/commands/shell/) | [WP Console](https://github.com/weDevsOfficial/wp-console)

---

## 1. Evaluating PHP Expressions in Real Time

### WP-CLI Shell

**Start Shell:**
```bash
wp shell
```

**Interactive PHP:**
```php
// Evaluate expressions
> 2 + 2
4

> get_option('siteurl')
"https://example.com"

> get_current_user_id()
1
```

**WordPress Functions:**
```php
// Use WordPress functions
> get_posts(array('numberposts' => 5))
array(5) { ... }

> wp_get_current_user()
WP_User Object { ... }

> is_admin()
false
```

### WP Console

**Installation:**
```bash
wp plugin install wp-console --activate
```

**Access:**
- Visit `/wp-console` in admin
- Interactive PHP console in browser
- Real-time code execution

**Usage:**
```php
// Execute PHP code
get_option('siteurl');

// WordPress functions
get_posts();

// Custom code
$posts = get_posts(array('numberposts' => 10));
count($posts);
```

---

## 2. Inspecting Variables and Objects

### Variable Inspection

**Inspect Variables:**
```php
// Set variable
> $user_id = 1

// Get user object
> $user = get_userdata($user_id)

// Inspect object
> var_dump($user)
object(WP_User)#123 { ... }

// Print readable format
> print_r($user)
WP_User Object
(
    [data] => ...
    [ID] => 1
    ...
)
```

**Array Inspection:**
```php
// Get array
> $options = get_option('active_plugins')

// Inspect array
> print_r($options)
Array
(
    [0] => plugin1/plugin1.php
    [1] => plugin2/plugin2.php
)

// Count elements
> count($options)
2
```

### Object Properties

**Access Properties:**
```php
// Get post object
> $post = get_post(1)

// Access properties
> $post->ID
1

> $post->post_title
"Hello World"

> $post->post_status
"publish"
```

**Method Calls:**
```php
// Call methods
> $user = wp_get_current_user()
> $user->has_cap('administrator')
true

> $user->get('user_email')
"admin@example.com"
```

---

## 3. Testing Function Output Without Modifying Code

### Function Testing

**Test WordPress Functions:**
```php
// Test function
> wp_insert_post(array(
    'post_title' => 'Test Post',
    'post_content' => 'Test content',
    'post_status' => 'draft'
))
123

// Verify
> get_post(123)->post_title
"Test Post"
```

**Test Custom Functions:**
```php
// Test plugin function
> if (function_exists('my_plugin_function')) {
    my_plugin_function();
}

// Test with parameters
> my_custom_function('param1', 'param2')
"result"
```

### Hook Testing

**Test Hooks:**
```php
// Check if hook exists
> has_action('init')
true

// Get hook callbacks
> global $wp_filter;
> $wp_filter['init']->callbacks
array(...)

// Test hook firing
> do_action('my_custom_hook', 'test');
```

**Filter Testing:**
```php
// Test filter
> apply_filters('the_content', 'Test content')
"Test content"

// Test with multiple filters
> $content = 'Original';
> apply_filters('the_content', $content)
"Original" (after all filters)
```

### Query Testing

**Test Database Queries:**
```php
// Test WP_Query
> $query = new WP_Query(array('posts_per_page' => 5));
> $query->found_posts
10

> $query->posts
array(5) { ... }

// Test get_posts
> $posts = get_posts(array('numberposts' => 10));
> count($posts)
10
```

**Test Meta Queries:**
```php
// Query by meta
> $posts = get_posts(array(
    'meta_key' => 'featured',
    'meta_value' => '1'
));
> count($posts)
5
```

---

## 4. Advanced Shell Usage

### Multi-line Code

**Execute Blocks:**
```php
// Multi-line in wp shell
> $posts = get_posts(array('numberposts' => 5));
> foreach ($posts as $post) {
    echo $post->post_title . "\n";
}
```

**Complex Operations:**
```php
// Complex debugging
> $user_id = 1;
> $user = get_userdata($user_id);
> $caps = $user->allcaps;
> print_r($caps);
```

### Error Handling

**Test Error Scenarios:**
```php
// Test error handling
> try {
    $post = get_post(99999);
    echo $post->post_title;
} catch (Exception $e) {
    echo $e->getMessage();
}
```

**Debug Errors:**
```php
// Enable error display
> ini_set('display_errors', 1);

// Test function that might error
> my_function_that_might_fail();
```

---

## 5. Practical Debugging Examples

### Debug User Issues

**Check User:**
```php
> $user = get_userdata(1);
> $user->user_login
"admin"

> $user->user_email
"admin@example.com"

> $user->roles
array(1) { [0]=> string(10) "administrator" }
```

### Debug Post Issues

**Check Post:**
```php
> $post = get_post(123);
> $post->post_status
"publish"

> get_post_meta(123, 'custom_field', true)
"value"

> get_the_terms(123, 'category')
array(...)
```

### Debug Options

**Check Options:**
```php
> get_option('siteurl')
"https://example.com"

> get_option('active_plugins')
array(...)

> get_option('theme_mods_twentytwentyfour')
array(...)
```

### Debug Transients

**Check Transients:**
```php
> get_transient('my_transient')
"value"

> global $wpdb;
> $wpdb->get_var("SELECT option_value FROM {$wpdb->options} WHERE option_name = '_transient_my_transient'")
"value"
```

---

## Exam Tips

### Key Points to Remember

1. **WP-CLI Shell:**
   - `wp shell` to start
   - Interactive PHP environment
   - Real-time code execution
   - WordPress functions available

2. **WP Console:**
   - Browser-based console
   - Plugin installation required
   - Similar functionality to wp shell
   - Access via `/wp-console`

3. **Variable Inspection:**
   - `var_dump()` for detailed output
   - `print_r()` for readable output
   - Access object properties directly
   - Call methods on objects

4. **Function Testing:**
   - Test WordPress functions
   - Test custom functions
   - Test hooks and filters
   - Test database queries

5. **Best Practices:**
   - Use for quick testing
   - Don't modify production data
   - Test in staging first
   - Clean up test data

---

## Additional Resources

- [WP-CLI Shell](https://wp-cli.org/commands/shell/)
- [WP Console Plugin](https://wordpress.org/plugins/wp-console/)
- [PHP Interactive Shell](https://www.php.net/manual/en/features.commandline.interactive.php)
