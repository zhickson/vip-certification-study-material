# 6.36 Debugging in Production Safely - Study Notes

## Overview

Debugging in production requires using read-only or limited logging techniques, minimizing overhead during debugging, and rolling back temporary debug changes quickly.

**Key Reference:** [Safe Debugging - Section 6.6](./6.6-safe-debugging-non-production.md) | [PHP Error Logs - Section 6.3](./6.3-php-error-logs.md)

---

## 1. Using Read-Only or Limited Logging Techniques

### Read-Only Debugging

**Query Monitor:**
- Read-only inspection
- No code changes
- View queries, hooks, assets
- No performance impact when not active

**APM Tools:**
- New Relic, Datadog
- Passive monitoring
- No code modification
- Real-time insights

### Limited Logging

**Conditional Logging:**
```php
if ( defined( 'WP_DEBUG' ) && WP_DEBUG && isset( $_GET['debug'] ) ) {
    error_log( 'Debug info' );
}
```

**User-Specific:**
```php
if ( get_current_user_id() === 1 ) {
    error_log( 'Admin debug' );
}
```

---

## 2. Minimizing Overhead During Production Debugging

### Lightweight Debugging

**Avoid Expensive Operations:**
```php
// ❌ BAD
error_log( print_r( get_posts(), true ) );

// ✅ GOOD
if ( defined( 'WP_DEBUG' ) && WP_DEBUG ) {
    error_log( 'Post count: ' . wp_count_posts()->publish );
}
```

**Use Sampling:**
```php
// Only log 1% of requests
if ( rand( 1, 100 ) === 1 ) {
    error_log( 'Sampled debug info' );
}
```

---

## 3. Rolling Back Temporary Debug Changes Quickly

### Version Control

**Git:**
```bash
# Make debug changes
# Test
# Rollback
git checkout -- file.php
```

### Feature Flags

**Toggle Debug:**
```php
define( 'MY_PLUGIN_DEBUG', false ); // Toggle off
```

### Quick Removal

**Mark Debug Code:**
```php
// DEBUG: Remove after testing
if ( MY_PLUGIN_DEBUG ) {
    error_log( 'Debug' );
}
```

---

## Exam Tips

### Key Points to Remember

1. **Read-Only:**
   - Query Monitor
   - APM tools
   - No code changes

2. **Minimize Overhead:**
   - Lightweight logging
   - Conditional execution
   - Sampling

3. **Quick Rollback:**
   - Version control
   - Feature flags
   - Marked code

---

## Additional Resources

- [Safe Debugging - Section 6.6](./6.6-safe-debugging-non-production.md)
- [PHP Error Logs - Section 6.3](./6.3-php-error-logs.md)
