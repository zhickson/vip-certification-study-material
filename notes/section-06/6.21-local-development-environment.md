# 6.21 Local Development Environment Debugging - Study Notes

## Overview

Local development environments using Docker, wp-env, or custom stacks allow you to debug WordPress in isolated environments, sync data and configs with production, and profile local performance.

**Key Reference:** [wp-env Documentation](https://github.com/WordPress/gutenberg/tree/trunk/packages/env) | [Docker WordPress](https://hub.docker.com/_/wordpress)

---

## 1. Using Docker, wp-env, or Custom Stacks

### wp-env

**Setup:**
```bash
# Install wp-env
npm install -g @wordpress/env

# Start environment
wp-env start

# Access WordPress
# http://localhost:8888
```

**Debug Configuration:**
```json
{
  "core": "WordPress/WordPress#master",
  "phpVersion": "8.0",
  "plugins": ["./plugins/my-plugin"],
  "themes": ["./themes/my-theme"],
  "config": {
    "WP_DEBUG": true,
    "WP_DEBUG_LOG": true,
    "WP_DEBUG_DISPLAY": false
  }
}
```

### Docker

**Docker Compose:**
```yaml
version: '3.8'
services:
  wordpress:
    image: wordpress:latest
    ports:
      - "8080:80"
    environment:
      WORDPRESS_DEBUG: 1
      WORDPRESS_DB_HOST: db
      WORDPRESS_DB_USER: wordpress
      WORDPRESS_DB_PASSWORD: wordpress
    volumes:
      - ./wp-content:/var/www/html/wp-content
  db:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wordpress
      MYSQL_PASSWORD: wordpress
```

**Start:**
```bash
docker-compose up -d
```

### Local by Flywheel / Local

**Features:**
- One-click WordPress setup
- Built-in debugging tools
- Database management
- SSL support
- Easy site switching

---

## 2. Syncing Data and Configs with Production

### Database Sync

**Export Production:**
```bash
# Production
wp db export production.sql
```

**Import to Local:**
```bash
# Local
wp db import production.sql
wp search-replace 'https://production.com' 'http://local.test'
```

### File Sync

**Sync Uploads:**
```bash
# Sync uploads directory
rsync -avz production:/wp-content/uploads/ local:/wp-content/uploads/
```

**Sync Plugins/Themes:**
```bash
# Sync specific plugin
rsync -avz production:/wp-content/plugins/my-plugin/ local:/wp-content/plugins/my-plugin/
```

### Configuration Sync

**wp-config.php:**
```php
// Match production settings
define( 'WP_DEBUG', true );
define( 'WP_DEBUG_LOG', true );
define( 'WP_DEBUG_DISPLAY', false );
```

---

## 3. Profiling Local Performance

### Query Monitor

**Install:**
```bash
wp plugin install query-monitor --activate
```

**Profile:**
- View queries
- Check hooks
- Monitor HTTP requests
- Analyze performance

### Xdebug Profiling

**Enable:**
```ini
xdebug.mode=profile
xdebug.output_dir=/tmp
```

**Analyze:**
- Use KCacheGrind
- Identify bottlenecks
- Optimize code

---

## Exam Tips

### Key Points to Remember

1. **Local Environments:**
   - wp-env for quick setup
   - Docker for isolation
   - Local for GUI

2. **Syncing:**
   - Database export/import
   - File sync with rsync
   - Config matching

3. **Profiling:**
   - Query Monitor
   - Xdebug profiling
   - Performance testing

---

## Additional Resources

- [wp-env Documentation](https://github.com/WordPress/gutenberg/tree/trunk/packages/env)
- [Docker WordPress](https://hub.docker.com/_/wordpress)
- [Local by Flywheel](https://localwp.com/)
