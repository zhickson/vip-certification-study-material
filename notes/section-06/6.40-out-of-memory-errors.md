# 6.40 Out-of-Memory Errors - Study Notes

## Overview

Diagnosing and fixing PHP memory exhaustion involves increasing memory limits, profiling memory usage, and identifying memory-heavy plugins or queries.

**Key Reference:** [PHP Error Logs - Section 6.3](./6.3-php-error-logs.md)

---

## 1. Increasing Memory Limits

### WordPress Configuration

**wp-config.php:**
```php
define( 'WP_MEMORY_LIMIT', '256M' );
define( 'WP_MAX_MEMORY_LIMIT', '512M' );
```

### PHP Configuration

**php.ini:**
```ini
memory_limit = 256M
```

**Runtime:**
```php
ini_set( 'memory_limit', '256M' );
```

---

## 2. Profiling Memory Usage

### Check Memory

**Current Usage:**
```php
echo memory_get_usage();
echo memory_get_peak_usage();
```

**Log Memory:**
```php
error_log( 'Memory: ' . memory_get_usage() . ' / ' . ini_get( 'memory_limit' ) );
```

### Query Monitor

**Memory Panel:**
- Shows memory usage
- Per-request breakdown
- Identifies spikes

---

## 3. Identifying Memory-Heavy Plugins or Queries

### Plugin Testing

**Process:**
1. Disable all plugins
2. Enable one by one
3. Monitor memory
4. Identify culprit

### Query Analysis

**Large Queries:**
- Unbounded queries
- Large result sets
- Memory-intensive operations

**Fix:**
- Add limits
- Use pagination
- Optimize queries

---

## Exam Tips

### Key Points to Remember

1. **Memory Limits:**
   - wp-config.php
   - php.ini
   - Runtime setting

2. **Profiling:**
   - memory_get_usage()
   - Query Monitor
   - APM tools

3. **Identification:**
   - Plugin testing
   - Query analysis
   - Memory monitoring

---

## Additional Resources

- [PHP Error Logs - Section 6.3](./6.3-php-error-logs.md)
