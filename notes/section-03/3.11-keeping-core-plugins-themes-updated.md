# 3.11 Keeping Core, Plugins, and Themes Updated - Study Notes

## Overview

Keeping WordPress core, plugins, and themes updated is critical for security. Outdated software is a primary attack vector. This topic covers update management strategies, policies, and tools for maintaining secure WordPress installations.

**Key Reference:** [Updating WordPress - WordPress Codex](https://codex.wordpress.org/Updating_WordPress)

---

## 1. Why Updates Are Critical

### Security Vulnerabilities

- **Known Vulnerabilities:** Outdated software often has publicly disclosed vulnerabilities
- **Exploit Availability:** Attackers actively target known vulnerabilities
- **Patch Availability:** Updates often include security patches

### Statistics

- Most WordPress security breaches involve outdated software
- Plugins are common attack vectors when not updated
- Core updates are released regularly for security

---

## 2. Update Policies

### Define Update Policies

**For Production Environments:**

1. **Test First:** Always test updates in staging
2. **Schedule Updates:** Regular update windows
3. **Backup First:** Always backup before updating
4. **Monitor After:** Watch for issues post-update

### Update Frequency

**Critical Security Updates:**
- Apply immediately after testing
- May require emergency maintenance window

**Regular Updates:**
- Weekly or bi-weekly schedule
- During low-traffic periods

**Major Version Updates:**
- Extensive testing required
- May require code changes

---

## 3. WordPress Core Updates

### Automatic Updates

WordPress can automatically update for:
- Security releases (minor versions)
- Translation updates

**Configuration:**
```php
// In wp-config.php

// Enable automatic updates for security releases
define( 'WP_AUTO_UPDATE_CORE', true ); // All updates
// OR
define( 'WP_AUTO_UPDATE_CORE', 'minor' ); // Only minor (security) updates

// Disable automatic updates
define( 'WP_AUTO_UPDATE_CORE', false );
```

### Manual Updates

**Via Admin:**
1. Dashboard > Updates
2. Click "Update Now"
3. Wait for completion

**Via WP-CLI:**
```bash
# Check for updates
wp core check-update

# Update core
wp core update

# Update to specific version
wp core update --version=6.0
```

### Update Process

1. **Backup:** Full site backup
2. **Test:** Test in staging if possible
3. **Update:** Run update
4. **Verify:** Check site functionality
5. **Monitor:** Watch for errors

---

## 4. Plugin Updates

### Update Management

**Manual Updates:**
- Dashboard > Plugins > Updates
- Update individually or bulk update

**WP-CLI:**
```bash
# List outdated plugins
wp plugin list --update=available

# Update all plugins
wp plugin update --all

# Update specific plugin
wp plugin update plugin-name
```

### Update Policies

**Critical Plugins:**
- Update immediately for security patches
- Test thoroughly before production

**Regular Plugins:**
- Update on regular schedule
- Test in staging first

**Unused Plugins:**
- Delete if not needed
- Don't leave inactive plugins

---

## 5. Theme Updates

### Update Management

**Manual Updates:**
- Dashboard > Appearance > Themes
- Update available themes

**WP-CLI:**
```bash
# List outdated themes
wp theme list --update=available

# Update all themes
wp theme update --all

# Update specific theme
wp theme update theme-name
```

### Custom Themes

- Custom themes may not have updates
- Monitor for security issues
- Keep dependencies updated

---

## 6. Managing Updates at Scale

### WP-CLI for Multiple Sites

```bash
# Update all sites in a directory
for site in /path/to/sites/*/; do
	cd "$site"
	wp core update
	wp plugin update --all
	wp theme update --all
done
```

### Management Tools

**WordPress.com:**
- Managed updates for hosted sites

**ManageWP / MainWP:**
- Centralized update management
- Bulk update capabilities

**Custom Scripts:**
- Automated update scripts
- With rollback capabilities

---

## 7. Update Best Practices

### 1. Always Backup First

```bash
# Full backup before update
wp db export backup.sql
tar -czf backup.tar.gz wp-content/
```

### 2. Test in Staging

- Replicate production environment
- Test all functionality
- Verify compatibility

### 3. Update During Low Traffic

- Schedule maintenance windows
- Notify users if needed
- Minimize downtime

### 4. Monitor After Updates

- Check error logs
- Monitor site performance
- Verify functionality

### 5. Have Rollback Plan

```bash
# Quick rollback
wp core update --version=previous-version
wp plugin install plugin-name --version=previous-version --force
```

---

## 8. Monitoring Vulnerabilities

### Vulnerability Databases

- **WPScan:** WordPress vulnerability database
- **CVE Database:** Common Vulnerabilities and Exposures
- **WordPress Security Advisories:** Official security notices

### Automated Monitoring

**Plugins:**
- Wordfence Security
- Sucuri Security
- iThemes Security

**Services:**
- WPScan API
- Sucuri SiteCheck
- Security monitoring services

### Manual Monitoring

```bash
# Check for known vulnerabilities
wpscan --url example.com --enumerate vp,vt

# Check plugin versions
wp plugin list --format=table
```

---

## 9. Update Automation

### Automated Security Updates

```php
// In wp-config.php
define( 'WP_AUTO_UPDATE_CORE', 'minor' ); // Security updates only
```

### Custom Update Script

```php
// functions.php - Custom update handler
function custom_auto_update() {
	// Only for security updates
	if ( isset( $GLOBALS['wp_version'] ) ) {
		$current = $GLOBALS['wp_version'];
		// Check if security update available
		// Apply if needed
	}
}
add_action( 'wp_update_plugins', 'custom_auto_update' );
```

### CI/CD Integration

```yaml
# GitHub Actions example
name: Update WordPress
on:
  schedule:
    - cron: '0 2 * * 0' # Weekly
jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Update WordPress
        run: |
          wp core update
          wp plugin update --all
          wp theme update --all
```

---

## 10. Handling Update Failures

### Common Issues

1. **Plugin Conflicts:** Deactivate conflicting plugins
2. **Theme Issues:** Switch to default theme
3. **Database Issues:** Run database repair
4. **File Permission Issues:** Fix permissions

### Recovery Steps

```bash
# Enable maintenance mode
wp maintenance-mode activate

# Check for errors
wp core verify-checksums

# Repair database
wp db repair

# Deactivate problematic plugins
wp plugin deactivate plugin-name

# Rollback if needed
wp core update --version=previous-version
```

---

## Exam Tips

### Key Points to Remember

1. **Update Importance:**
   - Critical for security
   - Outdated software is primary attack vector
   - Regular updates prevent exploitation

2. **Update Policies:**
   - Test in staging first
   - Backup before updating
   - Schedule regular updates
   - Monitor after updates

3. **Update Methods:**
   - Admin dashboard
   - WP-CLI (recommended for scale)
   - Management tools

4. **Automation:**
   - Enable automatic security updates
   - Use WP-CLI for bulk updates
   - Integrate with CI/CD

5. **Best Practices:**
   - Always backup first
   - Test in staging
   - Update during low traffic
   - Have rollback plan
   - Monitor vulnerabilities

---

## Additional Resources

- [Updating WordPress - WordPress Codex](https://codex.wordpress.org/Updating_WordPress)
- [WP-CLI Commands - WP-CLI Handbook](https://wp-cli.org/commands/)
- [WordPress Security - WordPress.org](https://wordpress.org/support/article/hardening-wordpress/)
