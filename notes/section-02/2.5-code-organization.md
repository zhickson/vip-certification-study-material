# 2.5 Code Organization - Study Notes

## Overview

Proper code organization is essential for maintainability, scalability, and collaboration. This section covers structuring WordPress plugins and themes, naming conventions, separating concerns, and applying WordPress philosophies.

**Key Reference:** [Plugin Handbook - WordPress Developer Resources](https://developer.wordpress.org/plugins/)

---

## 1. Organize Custom Plugin Functionality into Logical File Structures

### Recommended Plugin Structure

**Standard Plugin Structure:**

```
my-plugin/
├── my-plugin.php              # Main plugin file
├── uninstall.php              # Uninstall handler
├── readme.txt                 # WordPress.org readme
├── includes/
│   ├── class-plugin-core.php  # Core functionality
│   ├── class-admin.php        # Admin functionality
│   ├── class-frontend.php     # Frontend functionality
│   ├── class-ajax.php         # AJAX handlers
│   ├── class-rest-api.php     # REST API endpoints
│   └── functions.php          # Helper functions
├── admin/
│   ├── css/
│   │   └── admin.css
│   ├── js/
│   │   └── admin.js
│   └── views/
│       └── settings-page.php
├── public/
│   ├── css/
│   │   └── public.css
│   ├── js/
│   │   └── public.js
│   └── views/
│       └── frontend-template.php
├── languages/
│   └── my-plugin.pot
└── vendor/                    # Composer dependencies
    └── autoload.php
```

### Main Plugin File

**Example Main Plugin File:**

```php
<?php
/**
 * Plugin Name: My Plugin
 * Plugin URI: https://example.com/my-plugin
 * Description: Description of my plugin
 * Version: 1.0.0
 * Author: Your Name
 * Author URI: https://example.com
 * License: GPL-2.0+
 * Text Domain: my-plugin
 * Domain Path: /languages
 */

// If this file is called directly, abort.
if ( ! defined( 'WPINC' ) ) {
	die;
}

// Define plugin constants
define( 'MY_PLUGIN_VERSION', '1.0.0' );
define( 'MY_PLUGIN_PATH', plugin_dir_path( __FILE__ ) );
define( 'MY_PLUGIN_URL', plugin_dir_url( __FILE__ ) );

// Autoloader
require_once MY_PLUGIN_PATH . 'includes/class-autoloader.php';

// Activation/Deactivation hooks
register_activation_hook( __FILE__, array( 'My_Plugin_Activator', 'activate' ) );
register_deactivation_hook( __FILE__, array( 'My_Plugin_Deactivator', 'deactivate' ) );

// Initialize plugin
function my_plugin_init() {
	$plugin = new My_Plugin_Core();
	$plugin->run();
}
add_action( 'plugins_loaded', 'my_plugin_init' );
```

### Class Organization

**Core Class:**

```php
<?php
/**
 * Core plugin class.
 *
 * @package My_Plugin
 */
class My_Plugin_Core {

	/**
	 * Admin instance.
	 *
	 * @var My_Plugin_Admin
	 */
	private $admin;

	/**
	 * Frontend instance.
	 *
	 * @var My_Plugin_Frontend
	 */
	private $frontend;

	/**
	 * Initialize plugin.
	 */
	public function __construct() {
		$this->load_dependencies();
		$this->set_locale();
		$this->define_admin_hooks();
		$this->define_frontend_hooks();
	}

	/**
	 * Load required dependencies.
	 */
	private function load_dependencies() {
		require_once MY_PLUGIN_PATH . 'includes/class-admin.php';
		require_once MY_PLUGIN_PATH . 'includes/class-frontend.php';

		$this->admin = new My_Plugin_Admin();
		$this->frontend = new My_Plugin_Frontend();
	}

	/**
	 * Set locale for internationalization.
	 */
	private function set_locale() {
		add_action( 'plugins_loaded', array( $this, 'load_textdomain' ) );
	}

	/**
	 * Load plugin text domain.
	 */
	public function load_textdomain() {
		load_plugin_textdomain(
			'my-plugin',
			false,
			dirname( plugin_basename( __FILE__ ) ) . '/languages'
		);
	}

	/**
	 * Register admin hooks.
	 */
	private function define_admin_hooks() {
		if ( is_admin() ) {
			$this->admin->init();
		}
	}

	/**
	 * Register frontend hooks.
	 */
	private function define_frontend_hooks() {
		$this->frontend->init();
	}

	/**
	 * Run plugin.
	 */
	public function run() {
		// Plugin is ready
	}
}
```

---

## 2. Use Consistent Naming Conventions for Templates

### Template Naming

**Theme Template Hierarchy:**

```
single-{post-type}.php
archive-{post-type}.php
taxonomy-{taxonomy}.php
page-{slug}.php
```

**Custom Template Naming:**

```php
// ✅ GOOD - Descriptive, consistent
my-plugin-admin-settings.php
my-plugin-frontend-display.php
my-plugin-ajax-handler.php

// ❌ BAD - Unclear, inconsistent
admin.php
front.php
ajax.php
```

**Function Naming:**

```php
// ✅ GOOD - Prefixed, descriptive
function my_plugin_get_user_data() {}
function my_plugin_save_settings() {}
function my_plugin_render_template() {}

// ❌ BAD - Generic, no prefix
function get_data() {}
function save() {}
function render() {}
```

**Class Naming:**

```php
// ✅ GOOD - Capitalized_Words, prefixed
class My_Plugin_Admin {}
class My_Plugin_Frontend {}
class My_Plugin_Ajax_Handler {}

// ❌ BAD - No prefix, unclear
class Admin {}
class Frontend {}
```

---

## 3. Separate Concerns (Logic vs Presentation vs Configuration)

### Separation of Concerns

**1. Logic (Business Logic):**

```php
// includes/class-data-handler.php
class My_Plugin_Data_Handler {

	public function get_posts( $args = array() ) {
		$defaults = array(
			'post_type' => 'post',
			'posts_per_page' => 10,
		);

		$args = wp_parse_args( $args, $defaults );
		return get_posts( $args );
	}

	public function save_post_meta( $post_id, $meta_key, $meta_value ) {
		return update_post_meta( $post_id, $meta_key, $meta_value );
	}
}
```

**2. Presentation (Templates/Views):**

```php
// admin/views/settings-page.php
<?php
/**
 * Settings page template.
 *
 * @var array $settings Plugin settings
 */
?>

<div class="wrap">
	<h1><?php echo esc_html( get_admin_page_title() ); ?></h1>

	<form method="post" action="options.php">
		<?php settings_fields( 'my_plugin_settings' ); ?>
		<?php do_settings_sections( 'my_plugin_settings' ); ?>
		<?php submit_button(); ?>
	</form>
</div>
```

**3. Configuration:**

```php
// includes/class-config.php
class My_Plugin_Config {

	const VERSION = '1.0.0';
	const TEXT_DOMAIN = 'my-plugin';

	public static function get_default_settings() {
		return array(
			'api_key' => '',
			'enable_feature' => true,
			'cache_duration' => 3600,
		);
	}

	public static function get_supported_post_types() {
		return array( 'post', 'page' );
	}
}
```

### MVC-like Pattern

**Model (Data):**

```php
// includes/models/class-post-model.php
class My_Plugin_Post_Model {

	public function find( $post_id ) {
		return get_post( $post_id );
	}

	public function create( $data ) {
		return wp_insert_post( $data );
	}

	public function update( $post_id, $data ) {
		$data['ID'] = $post_id;
		return wp_update_post( $data );
	}
}
```

**View (Presentation):**

```php
// public/views/class-post-view.php
class My_Plugin_Post_View {

	public function render( $post ) {
		ob_start();
		include MY_PLUGIN_PATH . 'public/views/post-template.php';
		return ob_get_clean();
	}
}
```

**Controller (Logic):**

```php
// includes/controllers/class-post-controller.php
class My_Plugin_Post_Controller {

	private $model;
	private $view;

	public function __construct() {
		$this->model = new My_Plugin_Post_Model();
		$this->view = new My_Plugin_Post_View();
	}

	public function display( $post_id ) {
		$post = $this->model->find( $post_id );
		if ( ! $post ) {
			return '';
		}

		return $this->view->render( $post );
	}
}
```

---

## 4. Apply WordPress Philosophies Like "Decisions, Not Options"

### "Decisions, Not Options"

**Principle:** Make smart defaults and reduce configuration burden.

**Example - Bad (Too Many Options):**

```php
// ❌ BAD - Too many options
function my_plugin_settings() {
	add_settings_field(
		'cache_enabled',
		'Enable Caching',
		'checkbox_callback',
		'my_plugin',
		'general'
	);

	add_settings_field(
		'cache_duration',
		'Cache Duration',
		'text_callback',
		'my_plugin',
		'general'
	);

	add_settings_field(
		'cache_type',
		'Cache Type',
		'select_callback',
		'my_plugin',
		'general'
	);

	// ... 20 more options
}
```

**Example - Good (Smart Defaults):**

```php
// ✅ GOOD - Smart defaults, minimal options
function my_plugin_settings() {
	// Only essential options
	add_settings_field(
		'api_key',
		'API Key',
		'text_callback',
		'my_plugin',
		'general'
	);

	// Cache is enabled by default, no option needed
	// Duration is optimized, no option needed
	// Type is automatically chosen, no option needed
}
```

### Other WordPress Philosophies

**1. Code is Poetry:**

- Write clean, readable code
- Follow standards
- Document well

**2. Design for the Majority:**

- Defaults work for 80% of users
- Advanced users can extend via hooks

**3. The Loop:**

- Use WordPress's built-in query system
- Don't reinvent the wheel

**Example:**

```php
// ✅ GOOD - Use WordPress Loop
if ( have_posts() ) {
	while ( have_posts() ) {
		the_post();
		the_title();
		the_content();
	}
}

// ❌ BAD - Custom query logic
$posts = get_posts();
foreach ( $posts as $post ) {
	echo $post->post_title;
	echo $post->post_content;
}
```

**4. Extensibility:**

- Provide hooks for customization
- Don't hardcode everything

```php
// ✅ GOOD - Extensible
function my_plugin_get_data() {
	$data = array(
		'key1' => 'value1',
		'key2' => 'value2',
	);

	return apply_filters( 'my_plugin_data', $data );
}

// ❌ BAD - Not extensible
function my_plugin_get_data() {
	return array(
		'key1' => 'value1',
		'key2' => 'value2',
	);
}
```

---

## Exam Tips

### Key Points to Remember

1. **File Structure:**
   - Organize by functionality
   - Separate admin/frontend
   - Use includes/ for core classes
   - Keep templates in views/

2. **Naming Conventions:**
   - Prefix everything with plugin name
   - Use descriptive names
   - Follow WordPress standards
   - Be consistent

3. **Separation of Concerns:**
   - Logic in classes
   - Presentation in templates
   - Configuration in constants/config
   - Use MVC-like patterns

4. **WordPress Philosophies:**
   - "Decisions, not options" - smart defaults
   - "Code is poetry" - clean, readable code
   - "Design for the majority" - work for 80%
   - Extensibility via hooks

---

## Additional Resources

- [Plugin Handbook - WordPress Developer Resources](https://developer.wordpress.org/plugins/)
- [Theme Handbook - WordPress Developer Resources](https://developer.wordpress.org/themes/)
- [WordPress Coding Standards - WordPress Developer Resources](https://developer.wordpress.org/coding-standards/wordpress-coding-standards/)
- [Plugin API - WordPress Developer Resources](https://developer.wordpress.org/plugins/plugin-basics/)
