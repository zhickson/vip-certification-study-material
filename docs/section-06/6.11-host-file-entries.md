# 6.11 Host File Entries - Study Notes

## Overview

The hosts file allows you to map domain names to IP addresses locally, enabling testing of staging environments with live domains and debugging DNS-related issues.

**Key Reference:** [Hosts File - Wikipedia](https://en.wikipedia.org/wiki/Hosts_(file))

---

## 1. Editing Hosts File to Map Domains to IPs

### Hosts File Locations

**Linux/macOS:**
```
/etc/hosts
```

**Windows:**
```
C:\Windows\System32\drivers\etc\hosts
```

### File Format

**Syntax:**
```
IP_ADDRESS    DOMAIN_NAME
```

**Example:**
```
127.0.0.1    localhost
192.0.2.1    staging.example.com
```

### Editing Hosts File

**Linux/macOS:**
```bash
# Edit with sudo
sudo nano /etc/hosts

# Or with vim
sudo vim /etc/hosts
```

**Windows:**
- Open Notepad as Administrator
- Open `C:\Windows\System32\drivers\etc\hosts`
- Edit and save

**Permissions:**
- Requires administrator/root access
- File is read-only by default
- Must save with elevated privileges

---

## 2. Testing Staging Environments with Live Domains

### Staging Environment Setup

**Map Staging IP:**
```
# /etc/hosts
192.0.2.100    example.com
192.0.2.100    www.example.com
```

**Benefits:**
- Test with production domain
- Verify SSL certificates
- Test cookie behavior
- Debug domain-specific issues

### WordPress Configuration

**wp-config.php:**
```php
// Staging uses production domain via hosts file
define( 'WP_HOME', 'https://example.com' );
define( 'WP_SITEURL', 'https://example.com' );
```

**Benefits:**
- Test absolute URLs
- Verify redirects
- Test domain-based features
- Debug multisite issues

### SSL Testing

**Test SSL with Production Domain:**
```
# /etc/hosts
192.0.2.100    example.com
```

**Access:**
```
https://example.com
```

**Verify:**
- SSL certificate validity
- Mixed content issues
- HTTPS redirects
- Certificate errors

---

## 3. Debugging DNS-Related Issues

### DNS Resolution Testing

**Check Resolution:**
```bash
# Check DNS resolution
nslookup example.com

# With hosts file entry, should resolve to hosts file IP
# Without hosts file, resolves to DNS server IP
```

**Ping Test:**
```bash
# Ping domain
ping example.com

# Should ping hosts file IP if entry exists
```

### Common DNS Issues

**1. Domain Not Resolving:**
- Check hosts file syntax
- Verify IP address
- Check file permissions
- Clear DNS cache

**2. Wrong IP Resolved:**
- Check hosts file entries
- Verify entry order
- Clear DNS cache
- Check for duplicates

**3. DNS Cache Issues:**
```bash
# macOS/Linux - Clear DNS cache
sudo dscacheutil -flushcache
sudo killall -HUP mDNSResponder

# Windows - Clear DNS cache
ipconfig /flushdns
```

### WordPress DNS Issues

**Multisite Domain Mapping:**
```
# /etc/hosts
192.0.2.100    site1.example.com
192.0.2.100    site2.example.com
```

**Subdomain Testing:**
```
# /etc/hosts
192.0.2.100    example.com
192.0.2.100    www.example.com
192.0.2.100    api.example.com
192.0.2.100    admin.example.com
```

---

## 4. Hosts File Best Practices

### Entry Format

**Correct Format:**
```
192.0.2.100    example.com    www.example.com
```

**Comments:**
```
# Staging environment
192.0.2.100    example.com
```

**Multiple Domains:**
```
192.0.2.100    example.com
192.0.2.100    www.example.com
192.0.2.100    api.example.com
```

### Organization

**Group Entries:**
```
# Production
192.0.2.1    prod.example.com

# Staging
192.0.2.100    staging.example.com

# Local Development
127.0.0.1    local.example.com
```

### Security Considerations

**Localhost Only:**
- Use 127.0.0.1 for local testing
- Avoid mapping to external IPs in production
- Remove entries when done testing

**Backup Original:**
```bash
# Backup before editing
cp /etc/hosts /etc/hosts.backup
```

---

## 5. Troubleshooting

### Common Problems

**1. Changes Not Taking Effect:**
- Clear DNS cache
- Restart browser
- Check file permissions
- Verify syntax

**2. Entry Not Working:**
- Check IP address
- Verify domain spelling
- Check for typos
- Remove trailing spaces

**3. Browser Cache:**
- Clear browser cache
- Use incognito/private mode
- Hard refresh (Ctrl+F5)

### Verification

**Test Resolution:**
```bash
# Check hosts file entry
cat /etc/hosts | grep example.com

# Test DNS resolution
host example.com

# Test with curl
curl -I http://example.com
```

---

## Exam Tips

### Key Points to Remember

1. **Hosts File Location:**
   - Linux/macOS: `/etc/hosts`
   - Windows: `C:\Windows\System32\drivers\etc\hosts`
   - Requires admin/root access

2. **Format:**
   - `IP_ADDRESS    DOMAIN_NAME`
   - Multiple domains on one line
   - Comments with `#`

3. **Use Cases:**
   - Test staging with production domain
   - Debug DNS issues
   - Local development
   - SSL certificate testing

4. **Troubleshooting:**
   - Clear DNS cache
   - Check file permissions
   - Verify syntax
   - Restart browser

5. **Best Practices:**
   - Backup original file
   - Use comments for organization
   - Remove entries when done
   - Test resolution after changes

---

## Additional Resources

- [Hosts File - Wikipedia](https://en.wikipedia.org/wiki/Hosts_(file))
- [How to Edit Hosts File](https://www.howtogeek.com/howto/27350/beginner-geek-how-to-edit-your-hosts-file/)
- [DNS Troubleshooting](https://developer.mozilla.org/en-US/docs/Web/HTTP/DNS)
