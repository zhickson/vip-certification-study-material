# 6.24 Remote Database Debugging with SSH Tunnels - Study Notes

## Overview

SSH tunnels provide secure connections to remote databases for troubleshooting, allowing you to query staging/production databases while protecting credentials during connections.

**Key Reference:** [SSH Tunneling](https://www.ssh.com/academy/ssh/tunneling)

---

## 1. Configuring SSH Tunnels for DB Access

### Basic SSH Tunnel

**Create Tunnel:**
```bash
ssh -L 3307:localhost:3306 user@remote-server.com
```

**Connect:**
```bash
mysql -h 127.0.0.1 -P 3307 -u username -p
```

### Persistent Tunnel

**Background Process:**
```bash
ssh -f -N -L 3307:localhost:3306 user@remote-server.com
```

**Options:**
- `-f`: Background
- `-N`: No remote command
- `-L`: Local port forwarding

---

## 2. Querying Staging/Production Databases

### Connect via Tunnel

**MySQL Client:**
```bash
mysql -h 127.0.0.1 -P 3307 -u dbuser -p database_name
```

**WP-CLI:**
```bash
# Update wp-config.php temporarily
define( 'DB_HOST', '127.0.0.1:3307' );

# Use WP-CLI
wp db query "SELECT * FROM wp_posts LIMIT 10"
```

### GUI Tools

**phpMyAdmin/Adminer:**
- Connect to `127.0.0.1:3307`
- Use tunneled connection
- Query remote database

---

## 3. Protecting Credentials During Connections

### SSH Key Authentication

**Use SSH Keys:**
```bash
ssh -i ~/.ssh/id_rsa -L 3307:localhost:3306 user@remote-server.com
```

### Secure Configuration

**Best Practices:**
- Use SSH keys (no passwords)
- Restrict SSH access
- Use strong passwords
- Enable firewall rules

---

## Exam Tips

### Key Points to Remember

1. **SSH Tunnels:**
   - `-L` for local port forwarding
   - Background with `-f -N`
   - Connect to localhost

2. **Security:**
   - Use SSH keys
   - Protect credentials
   - Secure connections

3. **Usage:**
   - Query remote databases
   - Debug production issues
   - Safe database access

---

## Additional Resources

- [SSH Tunneling](https://www.ssh.com/academy/ssh/tunneling)
- [MySQL Remote Access](https://dev.mysql.com/doc/refman/8.0/en/remote-access.html)
