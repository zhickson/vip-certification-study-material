# 6.13 Terminal-Based Tools - Study Notes

## Overview

Terminal-based tools provide powerful command-line utilities for analyzing server performance, monitoring resources, and debugging WordPress issues directly on the web server.

**Key Reference:** [Linux Command Line Tools](https://www.gnu.org/software/coreutils/manual/)

---

## 1. Common Terminal Commands for Server Analysis

### System Monitoring

**CPU and Memory:**
```bash
# CPU usage
top
htop

# Memory usage
free -h

# Process list
ps aux

# System load
uptime
```

**Disk Usage:**
```bash
# Disk space
df -h

# Directory sizes
du -sh /path/to/directory

# Find large files
find /path -type f -size +100M
```

**Network:**
```bash
# Network connections
netstat -tulpn

# Network traffic
iftop
nethogs

# Test connectivity
ping example.com
```

### Process Management

**View Processes:**
```bash
# All processes
ps aux

# WordPress processes
ps aux | grep php

# Apache/Nginx processes
ps aux | grep apache
ps aux | grep nginx
```

**Kill Processes:**
```bash
# Kill by PID
kill 1234

# Force kill
kill -9 1234

# Kill by name
pkill php-fpm
```

### File Operations

**View Files:**
```bash
# View file
cat file.txt

# View with pagination
less file.txt
more file.txt

# View last lines
tail -n 100 file.txt

# Follow file (real-time)
tail -f file.txt
```

**Search Files:**
```bash
# Find files
find /path -name "*.php"

# Search content
grep -r "search_term" /path

# Search with context
grep -r -A 5 -B 5 "search_term" /path
```

---

## 2. WordPress-Specific Terminal Commands

### Log Analysis

**View Error Logs:**
```bash
# WordPress debug log
tail -f wp-content/debug.log

# PHP error log
tail -f /var/log/php-errors.log

# Apache error log
tail -f /var/log/apache2/error.log

# Nginx error log
tail -f /var/log/nginx/error.log
```

**Search Logs:**
```bash
# Search for errors
grep -i error wp-content/debug.log

# Search for specific term
grep "Fatal error" wp-content/debug.log

# Count occurrences
grep -c "error" wp-content/debug.log
```

### File Permissions

**Check Permissions:**
```bash
# List with permissions
ls -la

# Check specific file
stat file.php

# Find files with wrong permissions
find . -type f ! -perm 644
```

**Fix Permissions:**
```bash
# Set file permissions
chmod 644 file.php

# Set directory permissions
chmod 755 directory

# Recursive
chmod -R 644 wp-content/uploads
```

### Database Access

**MySQL Command Line:**
```bash
# Connect to database
mysql -u username -p database_name

# Execute query
mysql -u username -p database_name -e "SELECT * FROM wp_posts LIMIT 10"

# Import SQL
mysql -u username -p database_name < backup.sql

# Export SQL
mysqldump -u username -p database_name > backup.sql
```

---

## 3. Performance Analysis

### Resource Monitoring

**CPU Usage:**
```bash
# Real-time CPU
top

# Summary
vmstat 1 10

# Per-process CPU
ps aux --sort=-%cpu | head -10
```

**Memory Usage:**
```bash
# Memory summary
free -h

# Detailed memory
cat /proc/meminfo

# Process memory
ps aux --sort=-%mem | head -10
```

**I/O Monitoring:**
```bash
# Disk I/O
iostat -x 1

# I/O wait
top (look for %wa)

# Disk activity
iotop
```

### WordPress Performance

**Check PHP Processes:**
```bash
# PHP-FPM processes
ps aux | grep php-fpm

# PHP memory usage
ps aux | grep php | awk '{sum+=$6} END {print sum/1024 " MB"}'
```

**Check Database Connections:**
```bash
# MySQL connections
mysqladmin -u root -p processlist

# Connection count
mysql -u root -p -e "SHOW STATUS LIKE 'Threads_connected'"
```

---

## 4. Security Analysis

### File Integrity

**Check File Changes:**
```bash
# Find modified files
find . -type f -mtime -1

# Compare files
diff file1.php file2.php

# Check file hashes
md5sum file.php
sha256sum file.php
```

**Find Suspicious Files:**
```bash
# Find PHP files with eval
grep -r "eval(" wp-content/

# Find base64 encoded content
grep -r "base64_decode" wp-content/

# Find suspicious functions
grep -r "exec\|system\|shell_exec" wp-content/
```

### Access Logs

**Apache Access Log:**
```bash
# View access log
tail -f /var/log/apache2/access.log

# Find failed logins
grep "wp-login.php" /var/log/apache2/access.log | grep " 401 "

# Find suspicious IPs
awk '{print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -rn
```

**Nginx Access Log:**
```bash
# View access log
tail -f /var/log/nginx/access.log

# Similar analysis as Apache
```

---

## 5. Maintenance Tasks

### Cleanup

**Remove Old Logs:**
```bash
# Find large log files
find . -name "*.log" -size +100M

# Rotate logs
logrotate /etc/logrotate.d/wordpress

# Clean old backups
find . -name "*.sql" -mtime +30 -delete
```

**Database Cleanup:**
```bash
# Optimize tables
mysqlcheck -u username -p --optimize database_name

# Repair tables
mysqlcheck -u username -p --repair database_name

# Analyze tables
mysqlcheck -u username -p --analyze database_name
```

### Backup

**File Backup:**
```bash
# Backup files
tar -czf backup-$(date +%Y%m%d).tar.gz wp-content/

# Backup with exclude
tar -czf backup.tar.gz --exclude='wp-content/cache' wp-content/
```

**Database Backup:**
```bash
# Backup database
mysqldump -u username -p database_name > backup.sql

# Compressed backup
mysqldump -u username -p database_name | gzip > backup.sql.gz
```

---

## Exam Tips

### Key Points to Remember

1. **System Monitoring:**
   - `top`, `htop` for CPU/memory
   - `df -h` for disk space
   - `free -h` for memory
   - `netstat` for network

2. **File Operations:**
   - `tail -f` for log monitoring
   - `grep` for searching
   - `find` for locating files
   - `chmod` for permissions

3. **Database:**
   - `mysql` for direct access
   - `mysqldump` for backups
   - `mysqlcheck` for maintenance

4. **Performance:**
   - Monitor CPU with `top`
   - Monitor memory with `free`
   - Check I/O with `iostat`
   - Analyze processes with `ps`

5. **Security:**
   - Check file permissions
   - Analyze access logs
   - Find suspicious files
   - Monitor file changes

---

## Additional Resources

- [Linux Command Line Tools](https://www.gnu.org/software/coreutils/manual/)
- [Bash Guide](https://www.gnu.org/software/bash/manual/)
- [System Administration Guide](https://www.tldp.org/LDP/sag/html/)
