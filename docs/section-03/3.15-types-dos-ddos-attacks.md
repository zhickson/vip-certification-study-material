# 3.15 Types of DoS and DDoS Attacks - Study Notes

## Overview

Denial of Service (DoS) and Distributed Denial of Service (DDoS) attacks aim to make WordPress sites unavailable by overwhelming server resources. Understanding attack types helps implement appropriate defenses.

**Key Reference:** [OWASP DoS](https://owasp.org/www-community/attacks/Denial_of_Service)

---

## 1. Volumetric Attacks

### What are Volumetric Attacks?

Volumetric attacks overwhelm network bandwidth with massive traffic volumes.

### Types

**UDP Flood:**
- Sends UDP packets to random ports
- Server responds with ICMP "Destination Unreachable"
- Consumes bandwidth

**ICMP Flood:**
- Sends ICMP echo requests (ping)
- Amplifies with spoofed source IPs
- Overwhelms network

**DNS Amplification:**
- Sends DNS queries with spoofed source IP
- Small query generates large response
- Amplifies attack traffic

### Impact on WordPress

- Network saturation
- Legitimate users can't access site
- Server resources consumed

---

## 2. Application-Layer Attacks

### What are Application-Layer Attacks?

Target specific application vulnerabilities to exhaust server resources.

### WordPress-Specific Attacks

**Login Brute Force:**
```php
// Repeated login attempts
// Overwhelms authentication system
POST /wp-login.php
username=admin&password=guess1
username=admin&password=guess2
// ... thousands of attempts
```

**XML-RPC Pingback:**
```php
// Exploit pingback feature
POST /xmlrpc.php
<?xml version="1.0"?>
<methodCall>
	<methodName>pingback.ping</methodName>
	<params>
		<param><value>target-site.com</value></param>
		<param><value>attacker-site.com</value></param>
	</params>
</methodCall>
// Can be used for amplification
```

**WP-Cron Exploitation:**
```php
// Trigger expensive cron jobs
// Multiple requests trigger same cron
// Exhausts server resources
```

**Search Query Attacks:**
```php
// Expensive search queries
GET /?s=complex+query+that+triggers+expensive+operations
// Repeated with variations
```

---

## 3. Protocol Attacks

### What are Protocol Attacks?

Exploit network protocol weaknesses to consume server resources.

### Types

**SYN Flood:**
- Sends TCP SYN packets
- Server allocates resources for connections
- Never completes handshake
- Exhausts connection resources

**TCP Reset:**
- Sends TCP RST packets
- Disrupts legitimate connections
- Causes connection resets

### Impact

- Connection pool exhaustion
- Legitimate users can't connect
- Server becomes unresponsive

---

## 4. Resource Exhaustion Attacks

### CPU Exhaustion

**Expensive Operations:**
```php
// Trigger expensive database queries
GET /?s=* // Wildcard search
GET /?cat=1&cat=2&cat=3... // Multiple categories

// Trigger expensive PHP operations
GET /endpoint-that-processes-large-datasets
```

**Infinite Loops:**
```php
// Vulnerable code
while ( true ) {
	process_data();
}
```

### Memory Exhaustion

**Large File Uploads:**
```php
// Upload very large files
POST /wp-admin/async-upload.php
Content-Length: 10GB
// Consumes memory during processing
```

**Memory Leaks:**
```php
// Code with memory leaks
function process() {
	$data = array();
	while ( true ) {
		$data[] = get_large_data(); // Never freed
	}
}
```

### Database Exhaustion

**Unbounded Queries:**
```php
// Query without limits
$posts = get_posts(); // No limit!
// Returns thousands of posts
// Exhausts database connections
```

**Complex Queries:**
```php
// Expensive JOIN operations
SELECT * FROM wp_posts p
JOIN wp_postmeta pm1 ON p.ID = pm1.post_id
JOIN wp_postmeta pm2 ON p.ID = pm2.post_id
// ... many joins
// Slow query blocks database
```

---

## 5. Brute Force Attacks

### Login Brute Force

**Pattern:**
```php
// Repeated login attempts
for ( $i = 0; $i < 10000; $i++ ) {
	POST /wp-login.php
	username=admin&password=password$i
}
```

**Impact:**
- Overwhelms authentication system
- Locks out legitimate users
- Consumes server resources

### API Brute Force

**REST API:**
```php
// Brute force API endpoints
GET /wp-json/wp/v2/users
GET /wp-json/wp/v2/users/1
GET /wp-json/wp/v2/users/2
// Enumerate users
```

**XML-RPC:**
```php
// Brute force via XML-RPC
POST /xmlrpc.php
// Multiple authentication attempts
```

---

## 6. WordPress-Specific Attack Vectors

### WP-Cron Exploitation

**Attack:**
```php
// Trigger expensive cron jobs
GET /wp-cron.php?doing_wp_cron
// Multiple simultaneous requests
// Each triggers cron execution
// Exhausts resources
```

**Mitigation:**
- Disable WP-Cron
- Use system cron instead
- Rate limit cron execution

### Pingback Attacks

**Attack:**
```php
// XML-RPC pingback amplification
POST /xmlrpc.php
// Pingback to target site
// Amplifies attack traffic
```

**Mitigation:**
- Disable XML-RPC
- Block pingback requests
- Rate limit XML-RPC

### Search Attacks

**Attack:**
```php
// Expensive search queries
GET /?s=*
GET /?s=*&post_type=any
// Triggers expensive database queries
```

**Mitigation:**
- Limit search query length
- Add query limits
- Cache search results
- Rate limit search

---

## 7. Attack Characteristics

### Volumetric Attacks
- High traffic volume
- Network bandwidth saturation
- Requires network-level mitigation

### Application-Layer Attacks
- Lower traffic volume
- Targets specific vulnerabilities
- Requires application-level mitigation

### Protocol Attacks
- Exploits protocol weaknesses
- Connection exhaustion
- Requires protocol-level mitigation

### Resource Exhaustion
- Targets specific resources
- CPU, memory, or database
- Requires resource limits

---

## Exam Tips

### Key Points to Remember

1. **Attack Types:**
   - Volumetric: High traffic volume
   - Application-layer: Target vulnerabilities
   - Protocol: Exploit protocols
   - Resource exhaustion: Exhaust specific resources

2. **WordPress-Specific:**
   - Login brute force
   - XML-RPC pingback
   - WP-Cron exploitation
   - Search query attacks

3. **Impact:**
   - Site unavailability
   - Resource exhaustion
   - Service disruption
   - Performance degradation

4. **Mitigation Levels:**
   - Network-level (volumetric)
   - Application-level (application-layer)
   - Resource limits (exhaustion)

---

## Additional Resources

- [OWASP DoS](https://owasp.org/www-community/attacks/Denial_of_Service)
- [DDoS Attacks - Cloudflare](https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/)
